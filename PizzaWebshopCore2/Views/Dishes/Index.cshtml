@model PizzaWebshopCore2.Models.Dishes.IndexViewModel
<div class="container">
    <div class="row">
        <h1>Pizzas</h1>
        <div style="overflow-y: scroll; max-height: 70vh;" class="col s12 m7 l8">

            @foreach (var dish in Model.Dishes)
            {

                <div style="opacity: 0.9" class="card blue-grey darken-1">
                    <div class="card-content white-text">
                        <span class="card-title">@dish.Name</span>
                        @foreach (var ingredient in dish.Ingredients)
                        {
                            <span>@ingredient.Name</span>
                        }
                    </div>
                    <div class="card-action">
                        <button value="@dish.Name" class="waves-effect waves-light btn addToCart"><i class="material-icons left">add</i>Add</button>

                    </div>
                </div>
            }
        </div>
        <div class="col s12 m5 l4">
            <div style="opacity: 0.9">
                <div class="collection" id="cart" style="overflow-y: scroll; max-height: 400px;"></div>  
                <button class="waves-effect waves-light btn hide"><i class="material-icons right">checkout</i>Checkout</button>
            </div>
        </div>
    </div>
</div>


    

<style>
    .added-dish:hover {
        cursor: pointer;
    }
    .collection {
        border: 0;
    }
</style>
<script type="text/javascript">

    (function() {
        var cart = document.getElementById('cart');
        var addableDishes = document.getElementsByClassName('addToCart');

        for (var i = 0; i < addableDishes.length; i++) {
            addableDishes[i].addEventListener('click',
                function() {
                    var dish = this.value;
                    addToCart(dish, cart);
                });
        }
    })();

    var addToCart = function(dish, cart) {
        
       
        if (document.getElementById(dish)) {

            var dishToUpdate = document.getElementById(dish);

            var dishCount = dishToUpdate.children[0].innerText;
            if (dishCount <= 0) {
                dishCount = 1;
            } else {
                dishCount++;
            }
            dishToUpdate.children[0].innerText = dishCount;


        } else {
            var a = document.createElement('a');

            a.setAttribute('id', dish);
            a.classList.add('collection-item');
            a.classList.add('added-dish');
            var span = document.createElement('span');
            span.classList.add('badge');
            a.appendChild(span);
            a.appendChild(document.createTextNode(dish));

            a.addEventListener('click',
                function () {
                    removeItemFromCart(this);
                });

            cart.appendChild(a);
        }
       
    };
  

    var removeItemFromCart = function (element) {
        
        var dishCount = element.children[0].innerText;
        if (dishCount <= 1) {
            element.parentNode.removeChild(element);
        } else {
            element.children[0].innerText--;
        }
        
        
        
    }
</script>